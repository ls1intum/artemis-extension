.iris-chat {
  min-height: 100vh;
  padding: var(--iris-layout-gutter);
  background: var(--iris-color-background-app);
  display: flex;
  justify-content: center;
  color: var(--iris-color-text-primary);
}

.iris-chat__surface {
  width: min(960px, 100%);
  gap: var(--iris-layout-stack-gap);
}

/* Header */
.iris-chat__header {
  border-bottom: 1px solid var(--iris-color-border-subtle);
  padding-bottom: var(--iris-space-sm);
  margin-bottom: var(--iris-space-md);
}

.iris-chat__logo {
  height: 36px;
  width: auto;
}

.iris-chat__menu-button {
  border-radius: var(--iris-radius-md);
}

.iris-chat__burger-icon {
  display: inline-flex;
  flex-direction: column;
  gap: 4px;
}

.iris-chat__burger-icon span {
  display: block;
  width: 18px;
  height: 2px;
  background: currentColor;
  border-radius: 999px;
}

/* Context bean */
.context-bean-container {
  margin-bottom: var(--iris-space-lg);
}

.context-bean {
  position: relative;
}

.context-bean-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--iris-space-md);
  cursor: pointer;
}

.context-info {
  display: flex;
  align-items: center;
  gap: var(--iris-space-sm);
}

.context-icon,
.context-lock-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--iris-color-text-accent);
}

.context-text {
  font-weight: var(--iris-font-weight-semibold);
  color: var(--iris-color-text-primary);
}

.context-subtext {
  display: block;
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
}

.context-dropdown-arrow {
  color: var(--iris-color-text-muted);
}

.context-dropdown-menu {
  margin-top: var(--iris-space-md);
  background: var(--iris-color-background-elevated);
  border-radius: var(--iris-radius-lg);
  border: 1px solid var(--iris-color-border-subtle);
  box-shadow: var(--iris-shadow-raised);
  padding: var(--iris-space-md);
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-md);
  max-height: 420px;
  overflow-y: auto;
}

.context-search-container {
  position: sticky;
  top: 0;
  background: inherit;
  padding-bottom: var(--iris-space-sm);
  border-bottom: 1px solid var(--iris-color-border-subtle);
  z-index: var(--iris-z-index-popover);
}

.search-results,
.context-list,
.session-list {
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-sm);
}

.search-section {
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-sm);
}

.session-empty,
.search-result-empty {
  text-align: center;
  padding: var(--iris-space-md);
  color: var(--iris-color-text-muted);
  font-size: var(--iris-font-size-small);
}

.search-result-item,
.context-item {
  display: flex;
  gap: var(--iris-space-sm);
  border: 1px solid var(--iris-color-border-subtle);
  border-radius: var(--iris-radius-md);
  padding: var(--iris-space-sm) var(--iris-space-md);
  background: var(--iris-color-background-surface);
  cursor: pointer;
  transition: var(--iris-transition-interactive);
}

.search-result-item:hover,
.context-item:hover {
  border-color: var(--iris-color-border-focus);
}

.search-result-icon,
.context-item-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--iris-radius-pill);
  background: var(--iris-color-action-secondary);
  color: var(--iris-color-action-secondary-foreground);
}

.search-result-title,
.context-item-title {
  font-weight: var(--iris-font-weight-medium);
  color: var(--iris-color-text-primary);
}

.search-result-subtitle,
.context-item-subtitle {
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
}

.lock-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-right: 4px;
  color: var(--iris-color-text-accent);
}

.dropdown-section-header {
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.dropdown-divider {
  height: 1px;
  background: var(--iris-color-border-subtle);
  margin: var(--iris-space-sm) 0;
}

.session-item {
  border: 1px solid var(--iris-color-border-subtle);
  border-radius: var(--iris-radius-md);
  padding: var(--iris-space-sm) var(--iris-space-md);
  display: flex;
  flex-direction: column;
  gap: 4px;
  background: var(--iris-color-background-surface);
  cursor: pointer;
  transition: var(--iris-transition-interactive);
}

.session-item:hover {
  border-color: var(--iris-color-border-focus);
}

.session-item.active {
  border-color: var(--iris-color-border-focus);
  box-shadow: var(--iris-focus-ring);
}

.session-meta {
  display: flex;
  gap: var(--iris-space-sm);
  color: var(--iris-color-text-muted);
  font-size: var(--iris-font-size-small);
}

.context-empty-info {
  text-align: center;
  color: var(--iris-color-text-muted);
  font-size: var(--iris-font-size-small);
  padding: var(--iris-space-sm);
}

/* Messages */
.chat-messages {
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-md);
  border: 1px solid var(--iris-color-border-subtle);
  border-radius: var(--iris-radius-lg);
  padding: var(--iris-space-lg);
  background: var(--iris-color-background-surface);
  max-height: 480px;
  overflow-y: auto;
}

.welcome-message {
  text-align: center;
  padding: var(--iris-space-lg);
  background: var(--iris-color-background-sunken);
  border-radius: var(--iris-radius-lg);
  border: 1px dashed var(--iris-color-border-subtle);
  color: var(--iris-color-text-secondary);
}

.chat-message {
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-sm);
  padding: var(--iris-space-md);
  border-radius: var(--iris-radius-md);
  background: var(--iris-color-background-elevated);
  border: 1px solid var(--iris-color-border-subtle);
  box-shadow: var(--iris-shadow-xs);
}

.chat-message.user {
  background: color-mix(in srgb, var(--iris-color-action-secondary) 20%, transparent);
}

.chat-message.assistant {
  background: var(--iris-color-background-surface);
}

.message-header {
  display: flex;
  justify-content: space-between;
  color: var(--iris-color-text-muted);
  font-size: var(--iris-font-size-small);
}

.message-sender {
  font-weight: var(--iris-font-weight-medium);
  color: var(--iris-color-text-secondary);
}

.message-content {
  color: var(--iris-color-text-primary);
  font-size: var(--iris-font-size-base);
  line-height: var(--iris-line-height-relaxed);
}

.message-content code,
.message-content pre {
  font-family: var(--iris-font-family-mono);
  background: var(--iris-color-background-sunken);
  border-radius: var(--iris-radius-sm);
  padding: 0 var(--iris-space-sm);
}

.message-feedback {
  display: inline-flex;
  gap: var(--iris-space-sm);
  margin-top: var(--iris-space-sm);
}

.feedback-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--iris-space-xs);
  border-radius: var(--iris-radius-pill);
  border: 1px solid transparent;
  padding: var(--iris-space-xs) var(--iris-space-sm);
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
  background: var(--iris-color-action-ghost);
  transition: var(--iris-transition-interactive);
  cursor: pointer;
}

.feedback-button svg {
  width: 14px;
  height: 14px;
}

.feedback-button:hover {
  background: var(--iris-color-action-ghost-hover);
  color: var(--iris-color-text-primary);
}

.feedback-button.selected {
  background: var(--iris-color-action-secondary);
  color: var(--iris-color-action-secondary-foreground);
}

.message-feedback.has-feedback {
  opacity: 1;
}

.thinking-indicator {
  display: flex;
  gap: var(--iris-space-sm);
  align-items: center;
  color: var(--iris-color-text-muted);
  font-size: var(--iris-font-size-small);
}

/* Referenced files */
.websocket-status-banner,
.referenced-files-banner {
  border-radius: var(--iris-radius-md);
  border: 1px solid var(--iris-color-border-subtle);
  background: var(--iris-color-background-sunken);
  padding: var(--iris-space-sm) var(--iris-space-md);
  margin-bottom: var(--iris-space-sm);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--iris-space-md);
}

.referenced-files-header {
  display: flex;
  align-items: center;
  gap: var(--iris-space-sm);
  cursor: pointer;
}

.referenced-files-list {
  margin-top: var(--iris-space-sm);
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-xs);
}

.referenced-file-item {
  display: flex;
  align-items: center;
  gap: var(--iris-space-sm);
  padding: var(--iris-space-xs) var(--iris-space-sm);
  border-radius: var(--iris-radius-sm);
  background: var(--iris-color-background-surface);
  border: 1px solid var(--iris-color-border-subtle);
  font-size: var(--iris-font-size-small);
}

.referenced-file-item.excluded {
  border-color: var(--iris-color-status-warning);
  color: var(--iris-color-status-warning);
}

/* Composer */
.iris-chat__composer {
  display: flex;
  gap: var(--iris-space-sm);
  align-items: flex-end;
}

.iris-chat__textarea {
  min-height: 64px;
  resize: vertical;
}

.iris-chat__textarea:disabled {
  opacity: 0.6;
}

.iris-chat__disclaimer {
  margin-top: var(--iris-space-sm);
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
}

.settings-link {
  color: var(--iris-color-text-link);
}

/* Help popup */
.help-overlay,
.menu-overlay {
  position: fixed;
  inset: 0;
  background: var(--iris-color-overlay);
  opacity: 0;
  pointer-events: none;
  transition: var(--iris-transition-soft);
  z-index: var(--iris-z-index-overlay);
}

.help-overlay.open,
.menu-overlay.open {
  opacity: 1;
  pointer-events: auto;
}

.help-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: min(520px, 90vw);
  background: var(--iris-color-background-surface);
  border-radius: var(--iris-radius-lg);
  border: 1px solid var(--iris-color-border-subtle);
  box-shadow: var(--iris-shadow-raised);
  padding: var(--iris-space-lg);
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-md);
  opacity: 0;
  pointer-events: none;
  transition: var(--iris-transition-soft);
  z-index: var(--iris-z-index-modal);
}

.help-popup.open {
  opacity: 1;
  pointer-events: auto;
}

.help-popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.help-section {
  border: 1px solid var(--iris-color-border-subtle);
  border-radius: var(--iris-radius-lg);
  padding: var(--iris-space-md);
  background: var(--iris-color-background-surface);
}

.help-section-header {
  display: flex;
  align-items: center;
  gap: var(--iris-space-sm);
  margin-bottom: var(--iris-space-sm);
}

.help-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--iris-radius-pill);
  background: var(--iris-color-action-secondary);
  color: var(--iris-color-action-secondary-foreground);
}

/* Side menu */
.side-menu {
  position: fixed;
  top: 0;
  right: -380px;
  width: 340px;
  height: 100vh;
  background: var(--iris-color-background-surface);
  box-shadow: -8px 0 24px rgba(15, 23, 42, 0.35);
  border-left: 1px solid var(--iris-color-border-subtle);
  display: flex;
  flex-direction: column;
  transition: var(--iris-transition-soft);
  z-index: var(--iris-z-index-popover);
}

.side-menu.open {
  right: 0;
}

.side-menu-header {
  padding: var(--iris-space-md);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--iris-color-border-subtle);
}

.side-menu-content {
  padding: var(--iris-space-md);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-lg);
}

.menu-section {
  display: flex;
  flex-direction: column;
  gap: var(--iris-space-sm);
}

.menu-item {
  display: flex;
  align-items: flex-start;
  gap: var(--iris-space-sm);
  padding: var(--iris-space-sm);
  border-radius: var(--iris-radius-md);
  cursor: pointer;
  transition: var(--iris-transition-interactive);
}

.menu-item:hover {
  background: var(--iris-color-action-ghost-hover);
}

.menu-item.destructive {
  color: var(--iris-color-status-danger);
}

.menu-item svg {
  width: 20px;
  height: 20px;
  color: currentColor;
}

.menu-item-title {
  font-weight: var(--iris-font-weight-medium);
  color: var(--iris-color-text-primary);
}

.menu-item-description {
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-muted);
}

.menu-info {
  font-size: var(--iris-font-size-small);
  color: var(--iris-color-text-secondary);
}

/* Responsive */
@media (max-width: 900px) {
  .iris-chat {
    padding: var(--iris-space-md);
  }

  .iris-chat__surface {
    padding: var(--iris-space-md);
  }

  .chat-messages {
    max-height: 360px;
  }

  .side-menu {
    width: min(320px, 90vw);
  }
}
